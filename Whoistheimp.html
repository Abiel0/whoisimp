<!DOCTYPE html><html lang="en"><head><meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' data: blob: https://cdnjs.cloudflare.com https://cdn.jsdelivr.net https://code.jquery.com https://unpkg.com https://d3js.org https://threejs.org https://cdn.plot.ly https://stackpath.bootstrapcdn.com https://maps.googleapis.com https://cdn.tailwindcss.com https://ajax.googleapis.com https://kit.fontawesome.com https://cdn.datatables.net https://maxcdn.bootstrapcdn.com https://code.highcharts.com https://tako-static-assets-production.s3.amazonaws.com https://www.youtube.com https://fonts.googleapis.com https://fonts.gstatic.com https://pfst.cf2.poecdn.net https://puc.poecdn.net https://i.imgur.com https://wikimedia.org https://*.icons8.com https://*.giphy.com https://picsum.photos https://images.unsplash.com; frame-src 'self' https://www.youtube.com https://trytako.com; child-src 'self'; manifest-src 'self'; worker-src 'self'; upgrade-insecure-requests; block-all-mixed-content;">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Who is the Imposter? | ‡¥Ü‡¥∞‡¥æ‡¥£‡µç ‡¥µ‡¥û‡µç‡¥ö‡¥ï‡µª?</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            padding: 40px;
            max-width: 500px;
            width: 100%;
            text-align: center;
        }

        .logo {
            font-size: 2.5em;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #666;
            margin-bottom: 30px;
            font-size: 1.1em;
        }

        .language-toggle {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255,255,255,0.2);
            border: 2px solid rgba(255,255,255,0.3);
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 600;
            backdrop-filter: blur(10px);
            transition: all 0.3s;
        }

        .language-toggle:hover {
            background: rgba(255,255,255,0.3);
            transform: scale(1.05);
        }

        .input-group {
            margin-bottom: 20px;
            text-align: left;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }

        input, select {
            width: 100%;
            padding: 15px;
            border: 2px solid #e1e5e9;
            border-radius: 10px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        input:focus, select:focus {
            outline: none;
            border-color: #667eea;
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            width: 100%;
            margin-top: 10px;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .hidden {
            display: none;
        }

        .question-card {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 30px;
            margin: 20px 0;
            border-left: 5px solid #667eea;
        }

        .question-text {
            font-size: 1.3em;
            font-weight: 600;
            color: #333;
            line-height: 1.5;
        }

        .imposter-question {
            border-left-color: #e74c3c;
            background: #fdf2f2;
        }

        .players-list {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
        }

        .player-item {
            background: white;
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .status-badge {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: 600;
        }

        .status-waiting {
            background: #fff3cd;
            color: #856404;
        }

        .status-ready {
            background: #d4edda;
            color: #155724;
        }

        .game-id {
            background: #e9ecef;
            padding: 10px 15px;
            border-radius: 10px;
            font-family: monospace;
            font-size: 1.2em;
            font-weight: bold;
            margin: 15px 0;
            letter-spacing: 2px;
        }

        .reveal-section {
            margin-top: 30px;
            padding-top: 30px;
            border-top: 2px solid #e1e5e9;
        }

        .correct-answer {
            background: #d4edda;
            color: #155724;
            padding: 20px;
            border-radius: 10px;
            font-size: 1.2em;
            font-weight: 600;
            margin: 20px 0;
        }

        .round-counter {
            background: #667eea;
            color: white;
            padding: 10px 20px;
            border-radius: 20px;
            font-weight: 600;
            margin-bottom: 20px;
            display: inline-block;
        }

        @media (max-width: 600px) {
            .container {
                padding: 20px;
                margin: 10px;
            }
            
            .logo {
                font-size: 2em;
            }

            .language-toggle {
                position: relative;
                top: auto;
                right: auto;
                margin-bottom: 20px;
                display: inline-block;
            }
        }
    </style>
</head>
<body>
    <button class="language-toggle" onclick="toggleLanguage()" id="langToggle">‡¥Æ‡¥≤‡¥Ø‡¥æ‡¥≥‡¥Ç</button>

    <div class="container">
        <!-- Home Screen -->
        <div id="homeScreen">
            <div class="logo" data-en="üïµÔ∏è Who's the Imposter?" data-ml="üïµÔ∏è ‡¥Ü‡¥∞‡¥æ‡¥£‡µç ‡¥µ‡¥û‡µç‡¥ö‡¥ï‡µª?">üïµÔ∏è Who's the Imposter?</div>
            <p class="subtitle" data-en="Connect with friends and find the imposter among you!" data-ml="‡¥∏‡µÅ‡¥π‡µÉ‡¥§‡µç‡¥§‡µÅ‡¥ï‡µç‡¥ï‡¥≥‡µÅ‡¥Æ‡¥æ‡¥Ø‡¥ø ‡¥¨‡¥®‡µç‡¥ß‡¥ø‡¥™‡µç‡¥™‡¥ø‡¥ö‡µç‡¥ö‡µç ‡¥®‡¥ø‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥ü‡µÜ ‡¥á‡¥ü‡¥Ø‡¥ø‡¥≤‡µÜ ‡¥µ‡¥û‡µç‡¥ö‡¥ï‡¥®‡µÜ ‡¥ï‡¥£‡µç‡¥ü‡µÜ‡¥§‡µç‡¥§‡µÅ‡¥ï!">Connect with friends and find the imposter among you!</p>
            
            <div class="input-group">
                <label for="playerName" data-en="Your Name:" data-ml="‡¥®‡¥ø‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥ü‡µÜ ‡¥™‡µá‡¥∞‡µç:">Your Name:</label>
                <input type="text" id="playerName" data-en-placeholder="Enter your name" data-ml-placeholder="‡¥®‡¥ø‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥ü‡µÜ ‡¥™‡µá‡¥∞‡µç ‡¥®‡µΩ‡¥ï‡µÅ‡¥ï" placeholder="Enter your name" maxlength="20">
            </div>
            
            <button onclick="createGame()" data-en="Create New Game" data-ml="‡¥™‡µÅ‡¥§‡¥ø‡¥Ø ‡¥ó‡µÜ‡¥Ø‡¥ø‡¥Ç ‡¥∏‡µÉ‡¥∑‡µç‡¥ü‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥ï">Create New Game</button>
            <button onclick="showJoinForm()" data-en="Join Existing Game" data-ml="‡¥®‡¥ø‡¥≤‡¥µ‡¥ø‡¥≤‡µÅ‡¥≥‡µç‡¥≥ ‡¥ó‡µÜ‡¥Ø‡¥ø‡¥Æ‡¥ø‡µΩ ‡¥ö‡µá‡¥∞‡µÅ‡¥ï">Join Existing Game</button>
            
            <div id="joinForm" class="hidden" style="margin-top: 20px;">
                <div class="input-group">
                    <label for="gameId" data-en="Game ID:" data-ml="‡¥ó‡µÜ‡¥Ø‡¥ø‡¥Ç ‡¥ê‡¥°‡¥ø:">Game ID:</label>
                    <input type="text" id="gameId" data-en-placeholder="Enter 4-digit game ID" data-ml-placeholder="4 ‡¥Ö‡¥ï‡µç‡¥ï ‡¥ó‡µÜ‡¥Ø‡¥ø‡¥Ç ‡¥ê‡¥°‡¥ø ‡¥®‡µΩ‡¥ï‡µÅ‡¥ï" placeholder="Enter 4-digit game ID" maxlength="4">
                </div>
                <button onclick="joinGame()" data-en="Join Game" data-ml="‡¥ó‡µÜ‡¥Ø‡¥ø‡¥Æ‡¥ø‡µΩ ‡¥ö‡µá‡¥∞‡µÅ‡¥ï">Join Game</button>
            </div>
        </div>

        <!-- Lobby Screen -->
        <div id="lobbyScreen" class="hidden">
            <div class="logo" data-en="üéÆ Game Lobby" data-ml="üéÆ ‡¥ó‡µÜ‡¥Ø‡¥ø‡¥Ç ‡¥≤‡µã‡¥¨‡¥ø">üéÆ Game Lobby</div>
            <div class="round-counter" id="roundCounter">Round 1</div>
            <div class="game-id"><span data-en="Game ID:" data-ml="‡¥ó‡µÜ‡¥Ø‡¥ø‡¥Ç ‡¥ê‡¥°‡¥ø:">Game ID:</span> <span id="displayGameId"></span></div>
            <p class="subtitle" data-en="Share this ID with your friends!" data-ml="‡¥à ‡¥ê‡¥°‡¥ø ‡¥®‡¥ø‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥ü‡µÜ ‡¥∏‡µÅ‡¥π‡µÉ‡¥§‡µç‡¥§‡µÅ‡¥ï‡µç‡¥ï‡¥≥‡µÅ‡¥Æ‡¥æ‡¥Ø‡¥ø ‡¥™‡¥ô‡µç‡¥ï‡¥ø‡¥ü‡µÅ‡¥ï!">Share this ID with your friends!</p>
            
            <div class="players-list">
                <h3 style="margin-bottom: 15px; color: #333;"><span data-en="Players" data-ml="‡¥ï‡¥≥‡¥ø‡¥ï‡µç‡¥ï‡¥æ‡µº">Players</span> (<span id="playerCount">0</span>/4):</h3>
                <div id="playersList"></div>
            </div>
            
            <button id="startGameBtn" onclick="startGame()" disabled="" data-en="Start Game" data-ml="‡¥ó‡µÜ‡¥Ø‡¥ø‡¥Ç ‡¥Ü‡¥∞‡¥Ç‡¥≠‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥ï">Start Game</button>
        </div>

        <!-- Game Screen -->
        <div id="gameScreen" class="hidden">
            <div class="logo" data-en="üéØ Your Question" data-ml="üéØ ‡¥®‡¥ø‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥ü‡µÜ ‡¥ö‡µã‡¥¶‡µç‡¥Ø‡¥Ç">üéØ Your Question</div>
            <div class="round-counter" id="gameRoundCounter">Round 1</div>
            
            <div id="questionCard" class="question-card">
                <div class="question-text" id="questionText"></div>
            </div>
            
            <button id="answerBtn" onclick="markAnswered()" data-en="I Have an Answer!" data-ml="‡¥é‡¥®‡¥ø‡¥ï‡µç‡¥ï‡µç ‡¥â‡¥§‡µç‡¥§‡¥∞‡¥Æ‡µÅ‡¥£‡µç‡¥ü‡µç!">I Have an Answer!</button>
            
            <div class="players-list">
                <h3 style="margin-bottom: 15px; color: #333;" data-en="Player Status:" data-ml="‡¥ï‡¥≥‡¥ø‡¥ï‡µç‡¥ï‡¥æ‡¥∞‡µÅ‡¥ü‡µÜ ‡¥Ö‡¥µ‡¥∏‡µç‡¥•:">Player Status:</h3>
                <div id="gamePlayersList"></div>
            </div>
        </div>

        <!-- Reveal Screen -->
        <div id="revealScreen" class="hidden">
            <div class="logo" data-en="üé≠ Time to Reveal!" data-ml="üé≠ ‡¥µ‡µÜ‡¥≥‡¥ø‡¥™‡µç‡¥™‡µÜ‡¥ü‡µÅ‡¥§‡µç‡¥§‡¥æ‡¥®‡µÅ‡¥≥‡µç‡¥≥ ‡¥∏‡¥Æ‡¥Ø‡¥Ç!">üé≠ Time to Reveal!</div>
            <div class="round-counter" id="revealRoundCounter">Round 1</div>
            
            <div class="reveal-section">
                <h3 style="color: #333; margin-bottom: 15px;" data-en="The Real Question Was:" data-ml="‡¥Ø‡¥•‡¥æ‡µº‡¥§‡µç‡¥• ‡¥ö‡µã‡¥¶‡µç‡¥Ø‡¥Ç ‡¥á‡¥§‡¥æ‡¥Ø‡¥ø‡¥∞‡µÅ‡¥®‡µç‡¥®‡µÅ:">The Real Question Was:</h3>
                <div class="correct-answer" id="realQuestion"></div>
                
                <p style="color: #666; margin-top: 20px; line-height: 1.6;" data-en="Now discuss your answers in person! The imposter had a different question and must convince everyone their answer makes sense. Vote for who you think is the imposter!" data-ml="‡¥á‡¥™‡µç‡¥™‡µã‡µæ ‡¥®‡¥ø‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥ü‡µÜ ‡¥â‡¥§‡µç‡¥§‡¥∞‡¥ô‡µç‡¥ô‡µæ ‡¥®‡µá‡¥∞‡¥ø‡¥ü‡µç‡¥ü‡µç ‡¥ö‡µº‡¥ö‡µç‡¥ö ‡¥ö‡µÜ‡¥Ø‡µç‡¥Ø‡µÅ‡¥ï! ‡¥µ‡¥û‡µç‡¥ö‡¥ï‡¥®‡µç ‡¥µ‡µç‡¥Ø‡¥§‡µç‡¥Ø‡¥∏‡µç‡¥§‡¥Æ‡¥æ‡¥Ø ‡¥ö‡µã‡¥¶‡µç‡¥Ø‡¥Ç ‡¥â‡¥£‡µç‡¥ü‡¥æ‡¥Ø‡¥ø‡¥∞‡µÅ‡¥®‡µç‡¥®‡µÅ, ‡¥Ö‡¥µ‡¥∞‡µÅ‡¥ü‡µÜ ‡¥â‡¥§‡µç‡¥§‡¥∞‡¥Ç ‡¥Ö‡µº‡¥§‡µç‡¥•‡¥™‡µÇ‡µº‡¥£‡µç‡¥£‡¥Æ‡¥æ‡¥£‡µÜ‡¥®‡µç‡¥®‡µç ‡¥é‡¥≤‡µç‡¥≤‡¥æ‡¥µ‡¥∞‡µá‡¥Ø‡µÅ‡¥Ç ‡¥¨‡µã‡¥ß‡µç‡¥Ø‡¥™‡µç‡¥™‡µÜ‡¥ü‡µÅ‡¥§‡µç‡¥§‡¥£‡¥Ç. ‡¥Ü‡¥∞‡¥æ‡¥£‡µç ‡¥µ‡¥û‡µç‡¥ö‡¥ï‡¥®‡µÜ‡¥®‡µç‡¥®‡µç ‡¥®‡¥ø‡¥ô‡µç‡¥ô‡µæ ‡¥ï‡¥∞‡µÅ‡¥§‡µÅ‡¥®‡µç‡¥®‡µÅ‡¥µ‡µÜ‡¥®‡µç‡¥®‡µç ‡¥µ‡µã‡¥ü‡µç‡¥ü‡µç ‡¥ö‡µÜ‡¥Ø‡µç‡¥Ø‡µÅ‡¥ï!">Now discuss your answers in person! The imposter had a different question and must convince everyone their answer makes sense. Vote for who you think is the imposter!</p>
                
                <button onclick="playAgain()" style="margin-top: 30px;" data-en="Play Again" data-ml="‡¥µ‡µÄ‡¥£‡µç‡¥ü‡µÅ‡¥Ç ‡¥ï‡¥≥‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥ï">Play Again</button>
                <button onclick="newGame()" style="margin-top: 10px; background: #6c757d;" data-en="Leave Game" data-ml="‡¥ó‡µÜ‡¥Ø‡¥ø‡¥Ç ‡¥µ‡¥ø‡¥ü‡µÅ‡¥ï">Leave Game</button>
            </div>
        </div>
    </div>

    <script>
        // Language system
        let currentLanguage = 'en';
        
        function toggleLanguage() {
            currentLanguage = currentLanguage === 'en' ? 'ml' : 'en';
            updateLanguage();
        }
        
        function updateLanguage() {
            const elements = document.querySelectorAll('[data-en]');
            elements.forEach(element => {
                const text = element.getAttribute(`data-${currentLanguage}`);
                if (text) {
                    element.textContent = text;
                }
            });
            
            const inputs = document.querySelectorAll('[data-en-placeholder]');
            inputs.forEach(input => {
                const placeholder = input.getAttribute(`data-${currentLanguage}-placeholder`);
                if (placeholder) {
                    input.placeholder = placeholder;
                }
            });
            
            document.getElementById('langToggle').textContent = currentLanguage === 'en' ? '‡¥Æ‡¥≤‡¥Ø‡¥æ‡¥≥‡¥Ç' : 'English';
            
            // Update status badges
            updateStatusBadges();
        }
        
        function updateStatusBadges() {
            const readyText = currentLanguage === 'en' ? 'Ready' : '‡¥§‡¥Ø‡µç‡¥Ø‡¥æ‡µº';
            const answeredText = currentLanguage === 'en' ? 'Answered' : '‡¥â‡¥§‡µç‡¥§‡¥∞‡¥Ç ‡¥®‡µΩ‡¥ï‡¥ø';
            const thinkingText = currentLanguage === 'en' ? 'Thinking...' : '‡¥ö‡¥ø‡¥®‡µç‡¥§‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡µÅ...';
            
            document.querySelectorAll('.status-ready').forEach(badge => {
                if (badge.textContent === 'Ready' || badge.textContent === '‡¥§‡¥Ø‡µç‡¥Ø‡¥æ‡µº') {
                    badge.textContent = readyText;
                } else if (badge.textContent === 'Answered' || badge.textContent === '‡¥â‡¥§‡µç‡¥§‡¥∞‡¥Ç ‡¥®‡µΩ‡¥ï‡¥ø') {
                    badge.textContent = answeredText;
                }
            });
            
            document.querySelectorAll('.status-waiting').forEach(badge => {
                if (badge.textContent === 'Thinking...' || badge.textContent === '‡¥ö‡¥ø‡¥®‡µç‡¥§‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡µÅ...') {
                    badge.textContent = thinkingText;
                }
            });
        }

        // Game state
        let gameState = {
            gameId: null,
            playerName: null,
            isHost: false,
            players: [],
            currentQuestion: null,
            isImposter: false,
            currentRound: 1
        };

        // Question sets with Malayalam translations
        const questionSets = [
            {
                real: {
                    en: "What's your favorite pizza topping?",
                    ml: "‡¥®‡¥ø‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥ü‡µÜ ‡¥™‡µç‡¥∞‡¥ø‡¥Ø‡¥™‡µç‡¥™‡µÜ‡¥ü‡µç‡¥ü ‡¥™‡¥ø‡¥∏‡µç‡¥∏ ‡¥ü‡µã‡¥™‡µç‡¥™‡¥ø‡¥Ç‡¥ó‡µç ‡¥é‡¥®‡µç‡¥§‡¥æ‡¥£‡µç?"
                },
                imposter: {
                    en: "What's your favorite ice cream flavor?",
                    ml: "‡¥®‡¥ø‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥ü‡µÜ ‡¥™‡µç‡¥∞‡¥ø‡¥Ø‡¥™‡µç‡¥™‡µÜ‡¥ü‡µç‡¥ü ‡¥ê‡¥∏‡µç‡¥ï‡µç‡¥∞‡µÄ‡¥Ç ‡¥∞‡µÅ‡¥ö‡¥ø ‡¥é‡¥®‡µç‡¥§‡¥æ‡¥£‡µç?"
                }
            },
            {
                real: {
                    en: "What's the best vacation destination?",
                    ml: "‡¥è‡¥±‡µç‡¥±‡¥µ‡µÅ‡¥Ç ‡¥Æ‡¥ø‡¥ï‡¥ö‡µç‡¥ö ‡¥Ö‡¥µ‡¥ß‡¥ø‡¥ï‡µç‡¥ï‡¥æ‡¥≤ ‡¥∏‡µç‡¥•‡¥≤‡¥Ç ‡¥é‡¥®‡µç‡¥§‡¥æ‡¥£‡µç?"
                },
                imposter: {
                    en: "What's the best breakfast food?",
                    ml: "‡¥è‡¥±‡µç‡¥±‡¥µ‡µÅ‡¥Ç ‡¥Æ‡¥ø‡¥ï‡¥ö‡µç‡¥ö ‡¥™‡µç‡¥∞‡¥æ‡¥§‡µΩ ‡¥≠‡¥ï‡µç‡¥∑‡¥£‡¥Ç ‡¥é‡¥®‡µç‡¥§‡¥æ‡¥£‡µç?"
                }
            },
            {
                real: {
                    en: "What's your favorite movie genre?",
                    ml: "‡¥®‡¥ø‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥ü‡µÜ ‡¥™‡µç‡¥∞‡¥ø‡¥Ø‡¥™‡µç‡¥™‡µÜ‡¥ü‡µç‡¥ü ‡¥∏‡¥ø‡¥®‡¥ø‡¥Æ‡¥æ ‡¥µ‡¥ø‡¥≠‡¥æ‡¥ó‡¥Ç ‡¥é‡¥®‡µç‡¥§‡¥æ‡¥£‡µç?"
                },
                imposter: {
                    en: "What's your favorite type of music?",
                    ml: "‡¥®‡¥ø‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥ü‡µÜ ‡¥™‡µç‡¥∞‡¥ø‡¥Ø‡¥™‡µç‡¥™‡µÜ‡¥ü‡µç‡¥ü ‡¥∏‡¥Ç‡¥ó‡µÄ‡¥§ ‡¥µ‡¥ø‡¥≠‡¥æ‡¥ó‡¥Ç ‡¥é‡¥®‡µç‡¥§‡¥æ‡¥£‡µç?"
                }
            },
            {
                real: {
                    en: "What's the best way to spend a rainy day?",
                    ml: "‡¥Æ‡¥¥‡¥Ø‡µÅ‡¥≥‡µç‡¥≥ ‡¥¶‡¥ø‡¥µ‡¥∏‡¥Ç ‡¥ö‡µÜ‡¥≤‡¥µ‡¥¥‡¥ø‡¥ï‡µç‡¥ï‡¥æ‡¥®‡µÅ‡¥≥‡µç‡¥≥ ‡¥è‡¥±‡µç‡¥±‡¥µ‡µÅ‡¥Ç ‡¥®‡¥≤‡µç‡¥≤ ‡¥µ‡¥¥‡¥ø ‡¥é‡¥®‡µç‡¥§‡¥æ‡¥£‡µç?"
                },
                imposter: {
                    en: "What's the best way to stay cool in summer?",
                    ml: "‡¥µ‡µá‡¥®‡µΩ‡¥ï‡µç‡¥ï‡¥æ‡¥≤‡¥§‡µç‡¥§‡µç ‡¥§‡¥£‡µÅ‡¥™‡µç‡¥™‡µç ‡¥®‡¥ø‡¥≤‡¥®‡¥ø‡µº‡¥§‡µç‡¥§‡¥æ‡¥®‡µÅ‡¥≥‡µç‡¥≥ ‡¥è‡¥±‡µç‡¥±‡¥µ‡µÅ‡¥Ç ‡¥®‡¥≤‡µç‡¥≤ ‡¥µ‡¥¥‡¥ø ‡¥é‡¥®‡µç‡¥§‡¥æ‡¥£‡µç?"
                }
            },
            {
                real: {
                    en: "What's your favorite childhood memory?",
                    ml: "‡¥®‡¥ø‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥ü‡µÜ ‡¥™‡µç‡¥∞‡¥ø‡¥Ø‡¥™‡µç‡¥™‡µÜ‡¥ü‡µç‡¥ü ‡¥ï‡µÅ‡¥ü‡µç‡¥ü‡¥ø‡¥ï‡µç‡¥ï‡¥æ‡¥≤ ‡¥ì‡µº‡¥Æ‡µç‡¥Æ ‡¥é‡¥®‡µç‡¥§‡¥æ‡¥£‡µç?"
                },
                imposter: {
                    en: "What's your biggest fear?",
                    ml: "‡¥®‡¥ø‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥ü‡µÜ ‡¥è‡¥±‡µç‡¥±‡¥µ‡µÅ‡¥Ç ‡¥µ‡¥≤‡¥ø‡¥Ø ‡¥≠‡¥Ø‡¥Ç ‡¥é‡¥®‡µç‡¥§‡¥æ‡¥£‡µç?"
                }
            },
            {
                real: {
                    en: "What superpower would you want?",
                    ml: "‡¥è‡¥§‡µç ‡¥Ö‡¥Æ‡¥æ‡¥®‡µÅ‡¥∑‡¥ø‡¥ï ‡¥∂‡¥ï‡µç‡¥§‡¥ø‡¥Ø‡¥æ‡¥£‡µç ‡¥®‡¥ø‡¥ô‡µç‡¥ô‡µæ‡¥ï‡µç‡¥ï‡µç ‡¥µ‡µá‡¥£‡µç‡¥ü‡¥§‡µç?"
                },
                imposter: {
                    en: "What animal would you want as a pet?",
                    ml: "‡¥è‡¥§‡µç ‡¥Æ‡µÉ‡¥ó‡¥§‡µç‡¥§‡µÜ‡¥Ø‡¥æ‡¥£‡µç ‡¥®‡¥ø‡¥ô‡µç‡¥ô‡µæ ‡¥µ‡¥≥‡µº‡¥§‡µç‡¥§‡µÅ‡¥Æ‡µÉ‡¥ó‡¥Æ‡¥æ‡¥Ø‡¥ø ‡¥Ü‡¥ó‡µç‡¥∞‡¥π‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡¥§‡µç?"
                }
            },
            {
                real: {
                    en: "What's the best board game?",
                    ml: "‡¥è‡¥±‡µç‡¥±‡¥µ‡µÅ‡¥Ç ‡¥Æ‡¥ø‡¥ï‡¥ö‡µç‡¥ö ‡¥¨‡µã‡µº‡¥°‡µç ‡¥ó‡µÜ‡¥Ø‡¥ø‡¥Ç ‡¥é‡¥®‡µç‡¥§‡¥æ‡¥£‡µç?"
                },
                imposter: {
                    en: "What's the best video game?",
                    ml: "‡¥è‡¥±‡µç‡¥±‡¥µ‡µÅ‡¥Ç ‡¥Æ‡¥ø‡¥ï‡¥ö‡µç‡¥ö ‡¥µ‡µÄ‡¥°‡¥ø‡¥Ø‡µã ‡¥ó‡µÜ‡¥Ø‡¥ø‡¥Ç ‡¥é‡¥®‡µç‡¥§‡¥æ‡¥£‡µç?"
                }
            },
            {
                real: {
                    en: "What's your dream job?",
                    ml: "‡¥®‡¥ø‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥ü‡µÜ ‡¥∏‡µç‡¥µ‡¥™‡µç‡¥® ‡¥ú‡µã‡¥≤‡¥ø ‡¥é‡¥®‡µç‡¥§‡¥æ‡¥£‡µç?"
                },
                imposter: {
                    en: "What's your biggest accomplishment?",
                    ml: "‡¥®‡¥ø‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥ü‡µÜ ‡¥è‡¥±‡µç‡¥±‡¥µ‡µÅ‡¥Ç ‡¥µ‡¥≤‡¥ø‡¥Ø ‡¥®‡µá‡¥ü‡µç‡¥ü‡¥Ç ‡¥é‡¥®‡µç‡¥§‡¥æ‡¥£‡µç?"
                }
            },
            {
                real: {
                    en: "What's your favorite season?",
                    ml: "‡¥®‡¥ø‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥ü‡µÜ ‡¥™‡µç‡¥∞‡¥ø‡¥Ø‡¥™‡µç‡¥™‡µÜ‡¥ü‡µç‡¥ü ‡¥ï‡¥æ‡¥≤‡¥æ‡¥µ‡¥∏‡µç‡¥• ‡¥é‡¥®‡µç‡¥§‡¥æ‡¥£‡µç?"
                },
                imposter: {
                    en: "What's your favorite color?",
                    ml: "‡¥®‡¥ø‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥ü‡µÜ ‡¥™‡µç‡¥∞‡¥ø‡¥Ø‡¥™‡µç‡¥™‡µÜ‡¥ü‡µç‡¥ü ‡¥®‡¥ø‡¥±‡¥Ç ‡¥é‡¥®‡µç‡¥§‡¥æ‡¥£‡µç?"
                }
            },
            {
                real: {
                    en: "What's the best hobby to have?",
                    ml: "‡¥è‡¥±‡µç‡¥±‡¥µ‡µÅ‡¥Ç ‡¥Æ‡¥ø‡¥ï‡¥ö‡µç‡¥ö ‡¥π‡µã‡¥¨‡¥ø ‡¥é‡¥®‡µç‡¥§‡¥æ‡¥£‡µç?"
                },
                imposter: {
                    en: "What's the best sport to watch?",
                    ml: "‡¥ï‡¥æ‡¥£‡¥æ‡µª ‡¥è‡¥±‡µç‡¥±‡¥µ‡µÅ‡¥Ç ‡¥Æ‡¥ø‡¥ï‡¥ö‡µç‡¥ö ‡¥ï‡¥æ‡¥Ø‡¥ø‡¥ï ‡¥µ‡¥ø‡¥®‡µã‡¥¶‡¥Ç ‡¥é‡¥®‡µç‡¥§‡¥æ‡¥£‡µç?"
                }
            }
        ];

        // Local storage simulation
        function saveGameData(gameId, data) {
            localStorage.setItem(`game_${gameId}`, JSON.stringify(data));
            window.dispatchEvent(new StorageEvent('storage', {
                key: `game_${gameId}`,
                newValue: JSON.stringify(data)
            }));
        }

        function getGameData(gameId) {
            const data = localStorage.getItem(`game_${gameId}`);
            return data ? JSON.parse(data) : null;
        }

        window.addEventListener('storage', function(e) {
            if (e.key && e.key.startsWith('game_') && e.newValue) {
                const gameId = e.key.replace('game_', '');
                if (gameId === gameState.gameId) {
                    updateGameFromStorage();
                }
            }
        });

        function updateGameFromStorage() {
            const data = getGameData(gameState.gameId);
            if (data) {
                gameState.players = data.players || [];
                gameState.currentRound = data.currentRound || 1;
                
                const currentScreen = getCurrentScreen();
                
                // Handle transition back to lobby (when host clicks "Play Again")
                if (!data.gameStarted && !data.allAnswered && currentScreen === 'revealScreen') {
                    showLobby();
                    return;
                }
                
                updateLobby();
                updateGameScreen();
                updateRoundCounters();
                
                if (data.gameStarted && currentScreen === 'lobbyScreen') {
                    showGameScreen(data.questions);
                }
                
                if (data.allAnswered && currentScreen === 'gameScreen') {
                    showRevealScreen(data.realQuestion);
                }
            }
        }

        function getCurrentScreen() {
            const screens = ['homeScreen', 'lobbyScreen', 'gameScreen', 'revealScreen'];
            for (let screen of screens) {
                if (!document.getElementById(screen).classList.contains('hidden')) {
                    return screen;
                }
            }
            return null;
        }

        function generateGameId() {
            return Math.floor(1000 + Math.random() * 9000).toString();
        }

        function showJoinForm() {
            document.getElementById('joinForm').classList.remove('hidden');
        }

        function createGame() {
            const name = document.getElementById('playerName').value.trim();
            if (!name) {
                const alertMsg = currentLanguage === 'en' ? 'Please enter your name!' : '‡¥¶‡¥Ø‡¥µ‡¥æ‡¥Ø‡¥ø ‡¥®‡¥ø‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥ü‡µÜ ‡¥™‡µá‡¥∞‡µç ‡¥®‡µΩ‡¥ï‡µÅ‡¥ï!';
                alert(alertMsg);
                return;
            }

            gameState.gameId = generateGameId();
            gameState.playerName = name;
            gameState.isHost = true;
            gameState.currentRound = 1;
            gameState.players = [{
                name: name,
                answered: false
            }];

            const gameData = {
                players: gameState.players,
                gameStarted: false,
                currentRound: 1
            };

            saveGameData(gameState.gameId, gameData);
            showLobby();
        }

        function joinGame() {
            const name = document.getElementById('playerName').value.trim();
            const gameId = document.getElementById('gameId').value.trim();
            
            if (!name || !gameId) {
                const alertMsg = currentLanguage === 'en' ? 'Please enter both your name and game ID!' : '‡¥¶‡¥Ø‡¥µ‡¥æ‡¥Ø‡¥ø ‡¥®‡¥ø‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥ü‡µÜ ‡¥™‡µá‡¥∞‡µÅ‡¥Ç ‡¥ó‡µÜ‡¥Ø‡¥ø‡¥Ç ‡¥ê‡¥°‡¥ø‡¥Ø‡µÅ‡¥Ç ‡¥®‡µΩ‡¥ï‡µÅ‡¥ï!';
                alert(alertMsg);
                return;
            }

            const gameData = getGameData(gameId);
            if (!gameData) {
                const alertMsg = currentLanguage === 'en' ? 'Game not found! Please check the Game ID.' : '‡¥ó‡µÜ‡¥Ø‡¥ø‡¥Ç ‡¥ï‡¥£‡µç‡¥ü‡µÜ‡¥§‡µç‡¥§‡¥ø‡¥Ø‡¥ø‡¥≤‡µç‡¥≤! ‡¥ó‡µÜ‡¥Ø‡¥ø‡¥Ç ‡¥ê‡¥°‡¥ø ‡¥™‡¥∞‡¥ø‡¥∂‡µã‡¥ß‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥ï.';
                alert(alertMsg);
                return;
            }

            if (gameData.players.length >= 4) {
                const alertMsg = currentLanguage === 'en' ? 'This game is full!' : '‡¥à ‡¥ó‡µÜ‡¥Ø‡¥ø‡¥Ç ‡¥®‡¥ø‡¥±‡¥û‡µç‡¥û‡¥ø‡¥∞‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡µÅ!';
                alert(alertMsg);
                return;
            }

            if (gameData.gameStarted) {
                const alertMsg = currentLanguage === 'en' ? 'This game has already started!' : '‡¥à ‡¥ó‡µÜ‡¥Ø‡¥ø‡¥Ç ‡¥á‡¥§‡¥ø‡¥®‡¥ï‡¥Ç ‡¥Ü‡¥∞‡¥Ç‡¥≠‡¥ø‡¥ö‡µç‡¥ö‡¥ø‡¥∞‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡µÅ!';
                alert(alertMsg);
                return;
            }

            gameState.gameId = gameId;
            gameState.playerName = name;
            gameState.isHost = false;
            gameState.currentRound = gameData.currentRound || 1;

            gameData.players.push({
                name: name,
                answered: false
            });

            gameState.players = gameData.players;
            saveGameData(gameId, gameData);
            showLobby();
        }

        function showLobby() {
            // Hide all screens first
            document.getElementById('homeScreen').classList.add('hidden');
            document.getElementById('gameScreen').classList.add('hidden');
            document.getElementById('revealScreen').classList.add('hidden');
            
            // Show lobby screen
            document.getElementById('lobbyScreen').classList.remove('hidden');
            document.getElementById('displayGameId').textContent = gameState.gameId;
            updateLobby();
            updateRoundCounters();
        }

        function updateLobby() {
            const playersList = document.getElementById('playersList');
            const playerCount = document.getElementById('playerCount');
            const startBtn = document.getElementById('startGameBtn');

            playersList.innerHTML = '';
            const readyText = currentLanguage === 'en' ? 'Ready' : '‡¥§‡¥Ø‡µç‡¥Ø‡¥æ‡µº';
            
            gameState.players.forEach(player => {
                const playerDiv = document.createElement('div');
                playerDiv.className = 'player-item';
                playerDiv.innerHTML = `
                    <span>${player.name}</span>
                    <span class="status-badge status-ready">${readyText}</span>
                `;
                playersList.appendChild(playerDiv);
            });

            playerCount.textContent = gameState.players.length;
            
            if (gameState.isHost) {
                const needPlayersText = currentLanguage === 'en' ? 'Need at least 2 players' : '‡¥ï‡µÅ‡¥±‡¥û‡µç‡¥û‡¥§‡µç 2 ‡¥ï‡¥≥‡¥ø‡¥ï‡µç‡¥ï‡¥æ‡µº ‡¥Ü‡¥µ‡¥∂‡µç‡¥Ø‡¥Ç';
                const startGameText = currentLanguage === 'en' ? 'Start Game' : '‡¥ó‡µÜ‡¥Ø‡¥ø‡¥Ç ‡¥Ü‡¥∞‡¥Ç‡¥≠‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥ï';
                
                startBtn.disabled = gameState.players.length < 2;
                startBtn.textContent = gameState.players.length < 2 ? needPlayersText : startGameText;
            } else {
                const waitingText = currentLanguage === 'en' ? 'Waiting for host to start...' : '‡¥π‡µã‡¥∏‡µç‡¥±‡µç‡¥±‡µç ‡¥Ü‡¥∞‡¥Ç‡¥≠‡¥ø‡¥ï‡µç‡¥ï‡¥æ‡µª ‡¥ï‡¥æ‡¥§‡µç‡¥§‡¥ø‡¥∞‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡µÅ...';
                startBtn.textContent = waitingText;
                startBtn.disabled = true;
            }
        }

        function updateRoundCounters() {
            const roundText = currentLanguage === 'en' ? 'Round' : '‡¥±‡µó‡¥£‡µç‡¥ü‡µç';
            const roundDisplay = `${roundText} ${gameState.currentRound}`;
            
            document.getElementById('roundCounter').textContent = roundDisplay;
            document.getElementById('gameRoundCounter').textContent = roundDisplay;
            document.getElementById('revealRoundCounter').textContent = roundDisplay;
        }

        function startGame() {
            if (!gameState.isHost || gameState.players.length < 2) return;

            const questionSet = questionSets[Math.floor(Math.random() * questionSets.length)];
            const imposterIndex = Math.floor(Math.random() * gameState.players.length);
            
            const questions = gameState.players.map((player, index) => ({
                playerName: player.name,
                question: index === imposterIndex ? questionSet.imposter[currentLanguage] : questionSet.real[currentLanguage],
                isImposter: index === imposterIndex
            }));

            const gameData = getGameData(gameState.gameId);
            gameData.gameStarted = true;
            gameData.questions = questions;
            gameData.realQuestion = questionSet.real[currentLanguage];
            gameData.imposterQuestion = questionSet.imposter[currentLanguage];

            saveGameData(gameState.gameId, gameData);
            showGameScreen(questions);
        }

        function showGameScreen(questions) {
            document.getElementById('lobbyScreen').classList.add('hidden');
            document.getElementById('gameScreen').classList.remove('hidden');

            const playerQuestion = questions.find(q => q.playerName === gameState.playerName);
            if (playerQuestion) {
                gameState.currentQuestion = playerQuestion.question;
                gameState.isImposter = playerQuestion.isImposter;
                
                document.getElementById('questionText').textContent = playerQuestion.question;
                
                const questionCard = document.getElementById('questionCard');
                questionCard.classList.remove('imposter-question');
                if (playerQuestion.isImposter) {
                    questionCard.classList.add('imposter-question');
                }
            }

            // Reset answer button
            const answerBtn = document.getElementById('answerBtn');
            answerBtn.disabled = false;
            answerBtn.textContent = currentLanguage === 'en' ? 'I Have an Answer!' : '‡¥é‡¥®‡¥ø‡¥ï‡µç‡¥ï‡µç ‡¥â‡¥§‡µç‡¥§‡¥∞‡¥Æ‡µÅ‡¥£‡µç‡¥ü‡µç!';

            updateGameScreen();
        }

        function updateGameScreen() {
            const gamePlayersList = document.getElementById('gamePlayersList');
            gamePlayersList.innerHTML = '';
            
            const answeredText = currentLanguage === 'en' ? 'Answered' : '‡¥â‡¥§‡µç‡¥§‡¥∞‡¥Ç ‡¥®‡µΩ‡¥ï‡¥ø';
            const thinkingText = currentLanguage === 'en' ? 'Thinking...' : '‡¥ö‡¥ø‡¥®‡µç‡¥§‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡µÅ...';
            
            gameState.players.forEach(player => {
                const playerDiv = document.createElement('div');
                playerDiv.className = 'player-item';
                const statusClass = player.answered ? 'status-ready' : 'status-waiting';
                const statusText = player.answered ? answeredText : thinkingText;
                
                playerDiv.innerHTML = `
                    <span>${player.name}</span>
                    <span class="status-badge ${statusClass}">${statusText}</span>
                `;
                gamePlayersList.appendChild(playerDiv);
            });
        }

        function markAnswered() {
            const gameData = getGameData(gameState.gameId);
            
            const playerIndex = gameData.players.findIndex(p => p.name === gameState.playerName);
            if (playerIndex !== -1) {
                gameData.players[playerIndex].answered = true;
                gameState.players = gameData.players;
                
                const allAnswered = gameData.players.every(p => p.answered);
                if (allAnswered) {
                    gameData.allAnswered = true;
                }
                
                saveGameData(gameState.gameId, gameData);
                
                const answerBtn = document.getElementById('answerBtn');
                answerBtn.disabled = true;
                answerBtn.textContent = currentLanguage === 'en' ? 'Answer Submitted!' : '‡¥â‡¥§‡µç‡¥§‡¥∞‡¥Ç ‡¥∏‡¥Æ‡µº‡¥™‡µç‡¥™‡¥ø‡¥ö‡µç‡¥ö‡µÅ!';
                
                if (allAnswered) {
                    setTimeout(() => {
                        showRevealScreen(gameData.realQuestion);
                    }, 1000);
                }
            }
        }

        function showRevealScreen(realQuestion) {
            document.getElementById('gameScreen').classList.add('hidden');
            document.getElementById('revealScreen').classList.remove('hidden');
            document.getElementById('realQuestion').textContent = realQuestion;
        }

        function playAgain() {
            if (!gameState.isHost) {
                const alertMsg = currentLanguage === 'en' ? 'Only the host can start a new round!' : '‡¥™‡µÅ‡¥§‡¥ø‡¥Ø ‡¥±‡µó‡¥£‡µç‡¥ü‡µç ‡¥Ü‡¥∞‡¥Ç‡¥≠‡¥ø‡¥ï‡µç‡¥ï‡¥æ‡µª ‡¥π‡µã‡¥∏‡µç‡¥±‡µç‡¥±‡¥ø‡¥®‡µç ‡¥Æ‡¥æ‡¥§‡µç‡¥∞‡¥Æ‡µá ‡¥ï‡¥¥‡¥ø‡¥Ø‡µÇ!';
                alert(alertMsg);
                return;
            }

            // Reset player answered status
            gameState.players.forEach(player => {
                player.answered = false;
            });

            // Increment round
            gameState.currentRound++;

            const gameData = getGameData(gameState.gameId);
            gameData.players = gameState.players;
            gameData.currentRound = gameState.currentRound;
            gameData.gameStarted = false;
            gameData.allAnswered = false;
            delete gameData.questions;
            delete gameData.realQuestion;
            delete gameData.imposterQuestion;

            saveGameData(gameState.gameId, gameData);
            showLobby();
        }

        function newGame() {
            // Clear the current game from storage
            if (gameState.gameId) {
                localStorage.removeItem(`game_${gameState.gameId}`);
            }
            
            // Reset game state
            gameState = {
                gameId: null,
                playerName: null,
                isHost: false,
                players: [],
                currentQuestion: null,
                isImposter: false,
                currentRound: 1
            };
            
            // Clear form inputs
            document.getElementById('playerName').value = '';
            document.getElementById('gameId').value = '';
            document.getElementById('joinForm').classList.add('hidden');
            
            // Show home screen
            document.getElementById('revealScreen').classList.add('hidden');
            document.getElementById('homeScreen').classList.remove('hidden');
        }

        // Periodically check for game updates
        setInterval(updateGameFromStorage, 1000);

        // Initialize language on page load
        updateLanguage();
    </script>


</body></html>